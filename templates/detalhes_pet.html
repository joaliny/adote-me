{% extends 'base.html' %}
{% block title %}{{ pet.nome }} - Adote-me{% endblock %}
{% block content %}

<!-- Detalhes do Pet Section -->
<section class="pet-detalhes-section">
    <div class="container-detalhes">
        <div class="pet-detalhes">
            <div class="pet-content">
                <div class="pet-imagem">
                    <img src="{{ pet.imagem_url }}" alt="Foto do {{ pet.nome }}">
                </div>

                <div class="pet-info">
                    <h1 class="pet-nome">{{ pet.nome }}</h1>

                    <div class="pet-meta">
                        <span class="pet-tag">{{ pet.especie }}</span>
                        <span class="pet-tag">{{ pet.idade }} anos</span>
                    </div>

                    <div class="pet-descricao">
                        <p><strong>Sobre {{ pet.nome }}:</strong></p>
                        <p>{{ pet.descricao }}</p>
                    </div>

                    <!-- Botão Quero Adotar - Lógica para usuário logado/não logado -->
                    {% if usuario %}
                    <!-- Usuário LOGADO: mostra formulário diretamente -->
                    <button class="btn-adotar" onclick="document.getElementById('form-adocao').style.display='block'">
                        Quero Adotar {{ pet.nome }}
                    </button>
                    {% else %}
                    <!-- Usuário NÃO LOGADO: abre modal de login/cadastro -->
                    <button class="btn-adotar" onclick="abrirModalLogin()">
                        Quero Adotar {{ pet.nome }}
                    </button>
                    {% endif %}
                </div>
            </div>

            <!-- Formulário de Adoção - SÓ VISÍVEL PARA USUÁRIOS LOGADOS -->
            {% if usuario %}
            <div class="form-adocao-container">
                <div id="form-adocao" class="form-adocao" style="display: none;">
                    <div class="form-title">
                        <h3>Formulário de Adoção</h3>
                        <p>Preencha o formulário para solicitar a adoção de {{ pet.nome }}</p>
                    </div>
                    <form method="POST" action="{{ url_for('solicitar_adocao', id=pet.id) }}">
                        <div class="form-group">
                            <label for="nome">Seu nome completo:</label>
                            <input type="text" id="nome" name="nome" class="form-control"
                                placeholder="Digite seu nome completo" required value="{{ usuario.nome }}">
                        </div>

                        <div class="form-group">
                            <label for="email">Seu e-mail:</label>
                            <input type="email" id="email" name="email" class="form-control" placeholder="seu@email.com"
                                required value="{{ usuario.email }}">
                        </div>

                        <div class="form-group">
                            <label for="telefone">Seu telefone:</label>
                            <input type="tel" id="telefone" name="telefone" class="form-control"
                                placeholder="(00) 00000-0000" required>
                        </div>

                        <div class="form-group">
                            <label for="mensagem">Por que deseja adotar {{ pet.nome }}?</label>
                            <textarea id="mensagem" name="mensagem" class="form-control"
                                placeholder="Conte-nos um pouco sobre você e por que seria um bom tutor para {{ pet.nome }}..."
                                required rows="5"></textarea>
                        </div>

                        <button type="submit" class="btn-submit">Enviar Solicitação de Adoção</button>
                    </form>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</section>

<!-- Modal de Login/Cadastro para usuários NÃO LOGADOS -->
<div id="modal-login" class="modal">
    <div class="modal-conteudo">
        <span class="fechar" onclick="fecharModalLogin()">&times;</span>
        <h2>Faça login ou cadastre-se</h2>
        <p>Para solicitar a adoção de {{ pet.nome }}, você precisa estar logado.</p>

        <div class="opcoes-login">
            <a href="{{ url_for('login') }}?next={{ url_for('detalhes_pet', id=pet.id) }}" class="btn-login-modal">
                Fazer Login
            </a>
            <a href="{{ url_for('cadastro') }}?next={{ url_for('detalhes_pet', id=pet.id) }}"
                class="btn-cadastro-modal">
                Criar Cadastro
            </a>
        </div>

        <p class="texto-ajuda">
            Não se preocupe, o cadastro é rápido e gratuito!
        </p>
    </div>
</div>

<!-- Modal de confirmação -->
<div id="modal-confirmacao" class="modal">
    <div class="modal-conteudo">
        <span class="fechar" onclick="fecharModal()">&times;</span>
        <h2>Obrigado, {{ nome }}</h2>
        <p>Sua solicitação para adotar {{ pet.nome }} foi enviada com sucesso!</p>
        <p>Nossa equipe entrará em contato com você em até 48 horas.</p>

        <!-- ✅ CONTAINER PARA CENTRALIZAR O BOTÃO -->
        <div class="modal-botoes">
            <a href="{{ url_for('adotar') }}" class="btn-modal">Voltar para os pets</a>
        </div>
    </div>
</div>

<!-- Inclua o JavaScript externo -->
<script src="{{ url_for('static', filename='js/detalhes_pet.js') }}"></script>

{% endblock %}