{% extends 'base.html' %}
{% block title %}{{ pet.nome }} - Adote-me{% endblock %}
{% block content %}

<!-- Detalhes do Pet Section -->
<section class="pet-detalhes-section">
    <div class="container-detalhes">
        <div class="pet-detalhes">
            <div class="pet-content">
                <div class="pet-imagem">
                    <img src="{{ pet.imagem_url }}" alt="Foto do {{ pet.nome }}">
                </div>

                <div class="pet-info">
                    <h1 class="pet-nome">{{ pet.nome }}</h1>

                    <div class="pet-meta">
                        <span class="pet-tag">{{ pet.especie }}</span>
                        <span class="pet-tag">{{ pet.idade }} anos</span>
                        {% if pet.porte %}
                        <span class="pet-tag">{{ pet.porte|title }}</span>
                        {% endif %}
                        {% if pet.sexo %}
                        <span class="pet-tag">{{ 'Macho' if pet.sexo == 'macho' else 'Fêmea' }}</span>
                        {% endif %}
                    </div>

                    <!-- NOVAS INFORMAÇÕES ADICIONADAS -->
                    <div class="pet-detalhes-completos">
                        {% if pet.localizacao %}
                        <div class="info-item">
                            <i class="bi bi-geo-alt"></i>
                            <div class="info-content">
                                <strong>Localização:</strong>
                                <span>{{ pet.localizacao }}</span>
                            </div>
                        </div>
                        {% endif %}

                        {% if pet.raca %}
                        <div class="info-item">
                            <i class="bi bi-tag"></i>
                            <div class="info-content">
                                <strong>Raça:</strong>
                                <span>{{ pet.raca }}</span>
                            </div>
                        </div>
                        {% endif %}

                        {% if pet.cor %}
                        <div class="info-item">
                            <i class="bi bi-palette"></i>
                            <div class="info-content">
                                <strong>Cor:</strong>
                                <span>{{ pet.cor }}</span>
                            </div>
                        </div>
                        {% endif %}
                    </div>

                    {% if pet.historia %}
                    <div class="pet-historia">
                        <h3><i class="bi bi-book"></i> História do {{ pet.nome }}</h3>
                        <p>{{ pet.historia }}</p>
                    </div>
                    {% endif %}

                    {% if pet.informacoes_saude %}
                    <div class="pet-saude">
                        <h3><i class="bi bi-heart-pulse"></i> Informações de Saúde</h3>
                        <p>{{ pet.informacoes_saude }}</p>
                    </div>
                    {% endif %}

                    <div class="pet-descricao">
                        <h3><i class="bi bi-chat-left-text"></i> Sobre {{ pet.nome }}</h3>
                        <p>{{ pet.descricao }}</p>
                    </div>

                    <!-- Botão Quero Adotar - Lógica para usuário logado/não logado -->
                    {% if usuario %}
                    <!-- Usuário LOGADO: mostra formulário diretamente -->
                    <button class="btn-adotar" onclick="document.getElementById('form-adocao').style.display='block'">
                        <i class="bi bi-heart-fill"></i> Quero Adotar {{ pet.nome }}
                    </button>
                    {% else %}
                    <!-- Usuário NÃO LOGADO: abre modal de login/cadastro -->
                    <button class="btn-adotar" onclick="abrirModalLogin()">
                        <i class="bi bi-heart-fill"></i> Quero Adotar {{ pet.nome }}
                    </button>
                    {% endif %}
                </div>
            </div>

            <!-- Formulário de Adoção - SÓ VISÍVEL PARA USUÁRIOS LOGADOS -->
            {% if usuario %}
            <div class="form-adocao-container">
                <div id="form-adocao" class="form-adocao" style="display: none;">
                    <div class="form-title">
                        <h3><i class="bi bi-clipboard-check"></i> Formulário de Adoção</h3>
                        <p>Preencha o formulário para solicitar a adoção de {{ pet.nome }}</p>
                    </div>
                    <form method="POST" action="{{ url_for('solicitar_adocao', id=pet.id) }}">
                        <div class="form-group">
                            <label for="nome"><i class="bi bi-person"></i> Seu nome completo:</label>
                            <input type="text" id="nome" name="nome" class="form-control"
                                placeholder="Digite seu nome completo" required value="{{ usuario.nome }}">
                        </div>

                        <div class="form-group">
                            <label for="email"><i class="bi bi-envelope"></i> Seu e-mail:</label>
                            <input type="email" id="email" name="email" class="form-control" placeholder="seu@email.com"
                                required value="{{ usuario.email }}">
                        </div>

                        <div class="form-group">
                            <label for="telefone"><i class="bi bi-telephone"></i> Seu telefone:</label>
                            <input type="tel" id="telefone" name="telefone" class="form-control"
                                placeholder="(00) 00000-0000" required>
                        </div>

                        <div class="form-group">
                            <label for="mensagem"><i class="bi bi-chat-left-text"></i> Por que deseja adotar {{ pet.nome
                                }}?</label>
                            <textarea id="mensagem" name="mensagem" class="form-control"
                                placeholder="Conte-nos um pouco sobre você e por que seria um bom tutor para {{ pet.nome }}..."
                                required rows="5"></textarea>
                        </div>

                        <button type="submit" class="btn-submit">
                            <i class="bi bi-send"></i> Enviar Solicitação de Adoção
                        </button>
                    </form>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</section>

<!-- Modal de Login/Cadastro para usuários NÃO LOGADOS -->
<div id="modal-login" class="modal">
    <div class="modal-conteudo">
        <span class="fechar" onclick="fecharModalLogin()">&times;</span>
        <h2><i class="bi bi-person-circle"></i> Faça login ou cadastre-se</h2>
        <p>Para solicitar a adoção de {{ pet.nome }}, você precisa estar logado.</p>

        <div class="opcoes-login">
            <a href="{{ url_for('login') }}?next={{ url_for('detalhes_pet', id=pet.id) }}" class="btn-login-modal">
                <i class="bi bi-box-arrow-in-right"></i> Fazer Login
            </a>
            <a href="{{ url_for('cadastro') }}?next={{ url_for('detalhes_pet', id=pet.id) }}"
                class="btn-cadastro-modal">
                <i class="bi bi-person-plus"></i> Criar Cadastro
            </a>
        </div>

        <p class="texto-ajuda">
            <i class="bi bi-info-circle"></i> Não se preocupe, o cadastro é rápido e gratuito!
        </p>
    </div>
</div>

<!-- Modal de confirmação -->
<div id="modal-confirmacao" class="modal">
    <div class="modal-conteudo">
        <span class="fechar" onclick="fecharModal()">&times;</span>
        <h2><i class="bi bi-check-circle"></i> Obrigado, {{ nome }}</h2>
        <p>Sua solicitação para adotar {{ pet.nome }} foi enviada com sucesso!</p>
        <p>Nossa equipe entrará em contato com você em até 48 horas.</p>

        <!-- ✅ CONTAINER PARA CENTRALIZAR O BOTÃO -->
        <div class="modal-botoes">
            <a href="{{ url_for('adotar') }}" class="btn-modal">
                <i class="bi bi-arrow-left"></i> Voltar para os pets
            </a>
        </div>
    </div>
</div>

<style>
    /* ESTILOS PARA AS NOVAS INFORMAÇÕES */
    .pet-detalhes-completos {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 12px;
        margin: 20px 0;
        border-left: 4px solid #2877a3;
    }

    .info-item {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 12px;
        padding: 8px 0;
    }

    .info-item:last-child {
        margin-bottom: 0;
    }

    .info-item i {
        color: #2877a3;
        font-size: 1.1rem;
        width: 20px;
        text-align: center;
    }

    .info-content {
        flex: 1;
    }

    .info-content strong {
        color: #2c3e50;
        font-weight: 600;
        display: block;
        margin-bottom: 2px;
        font-size: 0.9rem;
    }

    .info-content span {
        color: #5a6c7d;
        font-size: 0.95rem;
    }

    .pet-historia,
    .pet-saude,
    .pet-descricao {
        background: white;
        padding: 20px;
        border-radius: 12px;
        margin: 15px 0;
        border: 1px solid #e9ecef;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    }

    .pet-historia h3,
    .pet-saude h3,
    .pet-descricao h3 {
        color: #2c3e50;
        font-size: 1.2rem;
        margin-bottom: 12px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .pet-historia h3 i {
        color: #e67e22;
    }

    .pet-saude h3 i {
        color: #e74c3c;
    }

    .pet-descricao h3 i {
        color: #3498db;
    }

    .pet-historia p,
    .pet-saude p,
    .pet-descricao p {
        color: #5a6c7d;
        line-height: 1.6;
        margin: 0;
    }

    .pet-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin: 15px 0;
    }

    .pet-tag {
        background: #e3f2fd;
        color: #2877a3;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 500;
        border: 1px solid #bbdefb;
    }

    .btn-adotar {
        background: linear-gradient(135deg, #e67e22, #d35400);
        color: white;
        border: none;
        padding: 14px 28px;
        border-radius: 50px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: 20px;
    }

    .btn-adotar:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(230, 126, 34, 0.3);
    }

    /* Responsividade */
    @media (max-width: 768px) {
        .pet-detalhes-completos {
            padding: 15px;
        }

        .info-item {
            flex-direction: column;
            align-items: flex-start;
            gap: 5px;
        }

        .pet-historia,
        .pet-saude,
        .pet-descricao {
            padding: 15px;
        }

        .pet-meta {
            gap: 6px;
        }

        .pet-tag {
            font-size: 0.8rem;
            padding: 4px 10px;
        }
    }
</style>

<!-- Inclua o JavaScript externo -->
<script src="{{ url_for('static', filename='js/detalhes_pet.js') }}"></script>

{% endblock %}