<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>{% block title %}Adote-me üêæ{% endblock %}</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

  <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
  <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">

  {% if pagina == 'home' %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}">
  {% endif %}
  {% if pagina == 'cadastrar' %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/cadastrar.css') }}">
  {% endif %}
  {% if pagina == 'adotar' %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/adotar.css') }}">
  {% endif %}
  {% if pagina == 'detalhes_pet' %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/detalhes_pet.css') }}">
  {% endif %}
</head>

<body data-mostrar-modal-login="{{ 'true' if mostrar_modal_login else 'false' }}"
  data-mostrar-modal="{{ 'true' if mostrar_modal else 'false' }}">

  <!-- Header e Navega√ß√£o -->
  <header class="bg-light shadow-sm">
    <div class="container">
      <nav class="navbar navbar-expand-lg navbar-light p-3">
        <a class="navbar-brand fw-bold" href="/home">Adote-<span class="text-primary">me üêæ</span></a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
          aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-between" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item"><a href="/home" class="nav-link {% if pagina == 'home' %}active{% endif %}">P√°gina Inicial</a></li>
            <li class="nav-item"><a href="/sobre" class="nav-link {% if pagina == 'sobre' %}active{% endif %}">Sobre n√≥s</a></li>
            <li class="nav-item"><a href="/blog" class="nav-link {% if pagina == 'blog' %}active{% endif %}">Blog</a></li>
            <li class="nav-item"><a href="/adotar" class="nav-link {% if pagina == 'adotar' %}active{% endif %}">Pets para ado√ß√£o</a></li>
            {% if usuario and usuario.tipo == 'admin' %}
            <li class="nav-item"><a href="/cadastrar" class="nav-link {% if pagina == 'cadastrar' %}active{% endif %}">Cadastrar Pet</a></li>
            {% endif %}
          </ul>

          <div class="d-flex align-items-center">
            {% if usuario and usuario.id %}
            <div class="dropdown">
              <button class="btn btn-outline-primary dropdown-toggle" type="button" data-bs-toggle="dropdown"
                aria-expanded="false">
                Ol√°, {{ usuario.nome }}
                {% if usuario.tipo == 'admin' %} üßë‚Äçüíª{% else %} üòä{% endif %}
              </button>
              <ul class="dropdown-menu dropdown-menu-end">
                {% if usuario.tipo == 'admin' %}
                <li><a class="dropdown-item" href="/admin"><i class="bi bi-speedometer2"></i> Dashboard Admin</a></li>
                <li><a class="dropdown-item" href="/admin/protetores"><i class="bi bi-people"></i> Gerenciar Usu√°rios</a></li>
                {% else %}
                <li><a class="dropdown-item" href="/meus-favoritos"><i class="bi bi-heart"></i> Meus Favoritos</a></li>
                <li><a class="dropdown-item" href="/minhas-adocoes"><i class="bi bi-house-check"></i> Minhas Ado√ß√µes</a></li>
                {% endif %}
                <li>
                  <hr class="dropdown-divider">
                </li>
                <li><a class="dropdown-item text-danger" href="/logout"><i class="bi bi-box-arrow-right"></i> Sair</a></li>
              </ul>
            </div>
            {% else %}
            <a href="/login" class="btn btn-link me-2">Entrar</a>
            <a href="/cadastro" class="btn btn-primary">Cadastrar</a>
            {% endif %}
          </div>
        </div>
      </nav>
    </div>
  </header>

  <!-- Conte√∫do da p√°gina -->
  <main class="container my-4">
    {% block content %}{% endblock %}
  </main>

  <!-- Footer global -->
  <footer class="bg-dark text-light py-4 mt-auto">
    <div class="container">
      <div class="row">
        <div class="col-12 col-md-4 mb-3">
          <div class="logo fs-4 fw-bold">Adote-<span class="text-white">meüêæ</span></div>
          <p>Conectando pets a lares amorosos desde 2025. Nossa miss√£o √© reduzir o n√∫mero de animais abandonados atrav√©s da ado√ß√£o respons√°vel.</p>
        </div>
        <div class="col-12 col-md-4 mb-3">
          <h5>Links R√°pidos</h5>
          <ul class="list-unstyled">
            <li><a class="text-light text-decoration-none" href="/home">P√°gina Inicial</a></li>
            <li><a class="text-light text-decoration-none" href="/sobre">Sobre n√≥s</a></li>
            <li><a class="text-light text-decoration-none" href="/blog">Blog</a></li>
            <li><a class="text-light text-decoration-none" href="/adotar">Pets para ado√ß√£o</a></li>
          </ul>
        </div>
        <div class="col-12 col-md-4 mb-3">
          <h5>Contato</h5>
          <ul class="list-unstyled">
            <li>Email: contato@adote-me.com</li>
            <li>Telefone: (92) 1234-5678</li>
            <li>Endere√ßo: Manaus, AM</li>
          </ul>
        </div>
      </div>
      <div class="text-center mt-3 small">&copy; 2025 Adote-me. Todos os direitos reservados.</div>
    </div>
  </footer>

  <script>
    // Fun√ß√µes JS mantidas conforme seu c√≥digo original
    function toggleFavorito(petId, button) {
      if (!button) return;

      fetch(`/api/favoritar/${petId}`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        }
      })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            const icon = button.querySelector('i');
            if (data.is_favorito) {
              icon.className = 'bi bi-heart-fill';
              button.classList.add('btn-favorito-ativo');
            } else {
              icon.className = 'bi bi-heart';
              button.classList.remove('btn-favorito-ativo');
            }
            showGlobalAlert(data.message, 'success');
          } else {
            showGlobalAlert(data.message, 'error');
          }
        })
        .catch(error => {
          console.error('Erro:', error);
          showGlobalAlert('Erro ao processar favorito.', 'error');
        });
    }

    function showGlobalAlert(message, type) {
      const alertClass = type === 'success' ? 'alert-success' : 'alert-danger';
      const alertDiv = document.createElement('div');
      alertDiv.className = `alert ${alertClass} alert-dismissible fade show position-fixed`;
      alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
      alertDiv.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
      `;
      document.body.appendChild(alertDiv);
      setTimeout(() => { if (alertDiv.parentNode) alertDiv.remove(); }, 3000);
    }

    document.addEventListener('DOMContentLoaded', function () {
      document.querySelectorAll('[data-pet-id]').forEach(button => {
        const petId = button.getAttribute('data-pet-id');
        fetch(`/api/verificar-favorito/${petId}`)
          .then(response => response.json())
          .then(data => {
            const icon = button.querySelector('i');
            if (data.is_favorito) {
              icon.className = 'bi bi-heart-fill';
              button.classList.add('btn-favorito-ativo');
            } else {
              icon.className = 'bi bi-heart';
              button.classList.remove('btn-favorito-ativo');
            }
          })
          .catch(error => console.error('Erro ao verificar favorito:', error));
      });
    });
  </script>

  <!-- Bootstrap JS Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>
